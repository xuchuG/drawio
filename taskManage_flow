<mxfile host="app.diagrams.net" modified="2020-08-07T02:37:39.582Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.1 Safari/605.1.15" etag="GqqKw5n4eLk4_CpqzGIN" version="13.6.0" type="github">
  <diagram id="nZh5rtcOLaGi2WGdM6vA" name="Page-1">
    <mxGraphModel dx="1888" dy="1706" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <object label="&lt;font style=&quot;font-size: 18px&quot;&gt;task&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div style=&quot;text-align: justify&quot;&gt;&lt;/div&gt;" id="UpMw4r_qUdOqaKaXqRXh-101">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFCCCC;" parent="1" vertex="1">
            <mxGeometry x="790" y="480" width="270" height="127.5" as="geometry" />
          </mxCell>
        </object>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-104" value="&lt;font style=&quot;font-size: 18px&quot;&gt;task&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="880.25" y="550" width="99.75" height="40" as="geometry" />
        </mxCell>
        <object label="&lt;font style=&quot;font-size: 18px&quot;&gt;node_manager&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div style=&quot;text-align: justify&quot;&gt;&lt;/div&gt;" id="UpMw4r_qUdOqaKaXqRXh-31">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFCCCC;" parent="1" vertex="1">
            <mxGeometry x="680" y="-140" width="270" height="225" as="geometry" />
          </mxCell>
        </object>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-32" value="&lt;font style=&quot;font-size: 18px&quot;&gt;node_manager&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="751" y="-70" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-72" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=-0.014;entryY=0.927;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-34" target="UpMw4r_qUdOqaKaXqRXh-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-74" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.a.1.2&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-72" vertex="1" connectable="0">
          <mxGeometry x="0.1063" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-129" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;strokeColor=#66CC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-34" target="UpMw4r_qUdOqaKaXqRXh-126" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-130" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.b&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-129" vertex="1" connectable="0">
          <mxGeometry x="0.2643" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-34" value="&lt;font style=&quot;font-size: 18px&quot;&gt;simpleNodeManager&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="729.5" y="30" width="171" height="40" as="geometry" />
        </mxCell>
        <object label="&lt;font style=&quot;font-size: 18px&quot;&gt;message_sys&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div style=&quot;text-align: justify&quot;&gt;&lt;/div&gt;" id="UpMw4r_qUdOqaKaXqRXh-20">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFCCCC;" parent="1" vertex="1">
            <mxGeometry x="240" y="-810" width="270" height="225" as="geometry" />
          </mxCell>
        </object>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-59" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-23" target="UpMw4r_qUdOqaKaXqRXh-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-60" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.a.1.3&lt;br&gt;monitorRegistered&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-59" vertex="1" connectable="0">
          <mxGeometry x="0.2925" y="-1" relative="1" as="geometry">
            <mxPoint x="21.05" y="-2.96" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;curved=1;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-23" target="UpMw4r_qUdOqaKaXqRXh-34" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="630" y="-600" />
              <mxPoint x="630" y="-330" />
              <mxPoint x="910" y="-330" />
              <mxPoint x="910" y="70" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-70" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.a.1.2&lt;br&gt;simpleNodeManager.addNode()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-69" vertex="1" connectable="0">
          <mxGeometry x="0.1072" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-23" value="&lt;font style=&quot;font-size: 18px&quot;&gt;etcd_based&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="309" y="-640" width="132" height="40" as="geometry" />
        </mxCell>
        <object label="&lt;font style=&quot;font-size: 18px&quot;&gt;taskManager&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;div style=&quot;text-align: justify&quot;&gt;&lt;/div&gt;" id="UpMw4r_qUdOqaKaXqRXh-2">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFCCCC;" parent="1" vertex="1">
            <mxGeometry x="-290" y="-300" width="460" height="225" as="geometry" />
          </mxCell>
        </object>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-11" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-1" target="UpMw4r_qUdOqaKaXqRXh-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-12" value="&lt;font style=&quot;font-size: 18px&quot;&gt;1.启动gracehttp&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-11" vertex="1" connectable="0">
          <mxGeometry x="0.1539" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-16" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-1" target="UpMw4r_qUdOqaKaXqRXh-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-17" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.1 taskMgrServer.new()&amp;nbsp;&lt;br&gt;新建对象，state--&amp;gt;slave&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-16" vertex="1" connectable="0">
          <mxGeometry x="-0.3884" y="2" relative="1" as="geometry">
            <mxPoint x="35.02" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-18" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-1" target="UpMw4r_qUdOqaKaXqRXh-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-19" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2 server()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-18" vertex="1" connectable="0">
          <mxGeometry x="-0.1591" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <object label="&lt;font style=&quot;font-size: 18px&quot;&gt;main&lt;/font&gt;" id="UpMw4r_qUdOqaKaXqRXh-1">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFCCCC;" parent="1" vertex="1">
            <mxGeometry x="-655" y="-220" width="90" height="40" as="geometry" />
          </mxCell>
        </object>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-3" value="&lt;font style=&quot;font-size: 18px&quot;&gt;TaskManager&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-140" y="-230" width="125.25" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-4" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;shape=flexArrow;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-60" y="-190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;curved=1;fillColor=#CC0000;strokeColor=#CC0000;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="310" y="-600" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-224" y="-70" />
              <mxPoint x="-350" y="-70" />
              <mxPoint x="-350" y="-600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-27" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.1 etcdsys.new()&lt;br&gt;新建对象&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-26" vertex="1" connectable="0">
          <mxGeometry x="-0.3585" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-40" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=30;entryDy=0;entryPerimeter=0;strokeColor=#CCCC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-5" target="UpMw4r_qUdOqaKaXqRXh-39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-41" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.2&amp;nbsp;&lt;br&gt;确定节点状态&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-40" vertex="1" connectable="0">
          <mxGeometry x="-0.1832" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-45" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=30;entryDy=0;entryPerimeter=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-5" target="UpMw4r_qUdOqaKaXqRXh-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-46" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3 开始跑核心流程&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-45" vertex="1" connectable="0">
          <mxGeometry x="0.173" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-5" value="&lt;font style=&quot;font-size: 18px&quot;&gt;taskMgrServer&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-224" y="-130" width="132" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-6" style="shape=flexArrow;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-7" target="UpMw4r_qUdOqaKaXqRXh-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-37" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#CC0000;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-7" target="UpMw4r_qUdOqaKaXqRXh-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-38" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.1.c.1 需先构建其内部simpleNodeManager&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-37" vertex="1" connectable="0">
          <mxGeometry x="-0.1577" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-49" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=15;entryDy=15;entryPerimeter=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-7" target="UpMw4r_qUdOqaKaXqRXh-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-50" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-49" vertex="1" connectable="0">
          <mxGeometry x="0.0966" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-7" value="&lt;font style=&quot;font-size: 18px&quot;&gt;simpleTaskManager&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-64" y="-130" width="157.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-10" value="&lt;font style=&quot;font-size: 18px&quot;&gt;gracehttp&lt;/font&gt;" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#FF99FF;" parent="1" vertex="1">
          <mxGeometry x="-670" y="-410" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-21" value="&lt;font style=&quot;font-size: 18px&quot;&gt;MessageSys&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="320.12" y="-740" width="109.75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-22" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;shape=flexArrow;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-23" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="375" y="-700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-29" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0;exitY=1;exitDx=0;exitDy=0;strokeColor=#CC0000;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-23" target="UpMw4r_qUdOqaKaXqRXh-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-30" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.1&amp;nbsp; 运行如下函数集&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-29" vertex="1" connectable="0">
          <mxGeometry x="0.0343" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-56" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=10;entryDy=70;entryPerimeter=0;strokeColor=#00FF80;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-23" target="UpMw4r_qUdOqaKaXqRXh-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-57" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.a.1.1&lt;br&gt;record&amp;nbsp; taskMsgChan&lt;br&gt;ctrlMsgChan&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-56" vertex="1" connectable="0">
          <mxGeometry x="0.3472" y="-2" relative="1" as="geometry">
            <mxPoint x="10.12" y="-0.45" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-35" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fillColor=#CC0000;strokeColor=#FF0000;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-28" target="UpMw4r_qUdOqaKaXqRXh-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-36" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.1.c 新建simpleTaskManager对象&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-35" vertex="1" connectable="0">
          <mxGeometry x="-0.3719" relative="1" as="geometry">
            <mxPoint x="-98.75" y="92.24000000000001" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-28" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;函数集：&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font size=&quot;3&quot;&gt;a.Start():etcd客户端初始化&lt;br&gt;&lt;/font&gt;&lt;div&gt;&lt;span&gt;&lt;font size=&quot;3&quot;&gt;b.CheckCluster():为etcd新建kv集&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;3&quot;&gt;c.NewSimpleManager()&lt;/font&gt;&lt;/div&gt;" style="shape=card;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="278.25" y="-450" width="194" height="110" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-33" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;shape=flexArrow;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-34" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="815" y="-30" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-53" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-34" target="UpMw4r_qUdOqaKaXqRXh-23" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="530" y="70" />
              <mxPoint x="530" y="-600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-54" value="&lt;font&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;2.2.3.a.a.1&lt;/span&gt;&lt;br&gt;&lt;div style=&quot;font-size: 14px ; text-align: left&quot;&gt;msgSys.WhenNodeRegister()&lt;/div&gt;&lt;div style=&quot;font-size: 14px ; text-align: left&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 1.etcd_based.addNode():将已经注册进写入etcd的name信息取出&lt;/div&gt;&lt;div style=&quot;font-size: 14px ; text-align: left&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 为节点创建taskMsgChan和ctrlMsgChan记录到Map中。&lt;/div&gt;&lt;div style=&quot;font-size: 14px ; text-align: left&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 2. simpleNodeManager.addNode():启动node&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;3.格外的还起了一个watch监控的协程&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-53" vertex="1" connectable="0">
          <mxGeometry x="0.2267" y="-2" relative="1" as="geometry">
            <mxPoint x="77.94" y="91.93" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-62" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.a.2&lt;br&gt;reportMetrics()&lt;/font&gt;" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#00CC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-34" target="UpMw4r_qUdOqaKaXqRXh-61" edge="1">
          <mxGeometry x="0.3857" y="11" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0;exitDx=0;exitDy=60;exitPerimeter=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;curved=1;strokeColor=#CCCC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-39" target="UpMw4r_qUdOqaKaXqRXh-23" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="441" y="-600" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-360" y="130" />
              <mxPoint x="-360" y="-350" />
              <mxPoint x="-20" y="-350" />
              <mxPoint x="-20" y="-550" />
              <mxPoint x="342" y="-550" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-43" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.2.a&lt;br&gt;msgSys.Campaign()&lt;br&gt;去竞选leader&lt;br&gt;不成，则加入一个监听器；&lt;br&gt;成了，则status=leader&amp;nbsp;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-42" vertex="1" connectable="0">
          <mxGeometry x="-0.7998" y="-1" relative="1" as="geometry">
            <mxPoint x="359.00000000000006" y="-455.00000000000006" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-39" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 函数集：&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font size=&quot;3&quot;&gt;a.onSlave()&lt;/font&gt;" style="shape=card;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-350" y="70" width="194" height="90" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-47" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a&lt;br&gt;Server()&lt;/font&gt;" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-44" target="UpMw4r_qUdOqaKaXqRXh-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-44" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 函数集：&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font size=&quot;3&quot;&gt;a.onLeader()&lt;/font&gt;" style="shape=card;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-82.25" y="70" width="194" height="100" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-51" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-48" target="UpMw4r_qUdOqaKaXqRXh-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-52" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.a&lt;br&gt;启动node&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-51" vertex="1" connectable="0">
          <mxGeometry x="0.0561" y="4" relative="1" as="geometry">
            <mxPoint x="-47.44" y="16.69" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-99" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;strokeColor=#66CC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-48" target="UpMw4r_qUdOqaKaXqRXh-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-100" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.b&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-99" vertex="1" connectable="0">
          <mxGeometry x="-0.2618" y="-5" relative="1" as="geometry">
            <mxPoint x="-17.86" y="4.710000000000001" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-48" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 函数集：&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font size=&quot;3&quot;&gt;a.node_manager.Start()&lt;br&gt;b.rebuildTasks()&lt;/font&gt;" style="shape=card;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="270" y="120" width="194" height="100" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-55" value="&lt;font style=&quot;font-size: 18px&quot;&gt;taskMsgChan&lt;br&gt;ctrlMsgChan&lt;br&gt;&amp;nbsp; &amp;nbsp;DB&lt;/font&gt;" style="shape=cube;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;darkOpacity=0.05;darkOpacity2=0.1;fillColor=#FFFFCC;" parent="1" vertex="1">
          <mxGeometry x="800" y="-860" width="150" height="90" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-58" value="&lt;font style=&quot;font-size: 18px&quot;&gt;协程&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;&lt;font size=&quot;3&quot;&gt;a. watch监听节点注册事件&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;&lt;font size=&quot;3&quot;&gt;b.etcd_based.addNode():需要为其创建对应的taskMsgChan,ctrlMsgChan加入Map中&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;&lt;font size=&quot;3&quot;&gt;c.simpleNodeManager.addNode():启动node&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" parent="1" vertex="1">
          <mxGeometry x="827" y="-590" width="323" height="121.91" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-61" value="&lt;font style=&quot;font-size: 18px&quot;&gt;协程&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font size=&quot;3&quot;&gt;&lt;span&gt;a. 监控所有exenode的节点情况，如cpu，memeory等，用来运维监控&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" parent="1" vertex="1">
          <mxGeometry x="1095.12" y="200" width="254.88" height="82.5" as="geometry" />
        </mxCell>
        <object label="node_server&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: justify&quot;&gt;&lt;/div&gt;" id="UpMw4r_qUdOqaKaXqRXh-63">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFCCCC;" parent="1" vertex="1">
            <mxGeometry x="1199.75" y="-753.09" width="270" height="127.5" as="geometry" />
          </mxCell>
        </object>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-77" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-64" target="UpMw4r_qUdOqaKaXqRXh-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-78" value="&lt;font style=&quot;font-size: 18px&quot;&gt;启动状态机&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-77" vertex="1" connectable="0">
          <mxGeometry x="0.3148" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-64" value="NodeServer" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1290" y="-683.09" width="99.75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-73" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-71" target="UpMw4r_qUdOqaKaXqRXh-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-76" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.a.1.2.b&lt;br&gt;Start()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-73" vertex="1" connectable="0">
          <mxGeometry x="0.1138" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-71" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;函数集：&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font size=&quot;3&quot;&gt;a.NewNodeServer()&lt;br&gt;b.Start()&lt;/font&gt;" style="shape=card;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="1115.75" y="-214.33999999999997" width="194" height="90" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-96" value="&lt;font style=&quot;font-size: 14px&quot;&gt;起始状态为StatusUnknown，后续接收来自nodeSever.cmdChan中的cmd转变状态&lt;br&gt;其字段来源于JobManager的http,同etcd_based.ctrlMsgChan查表得对应node的ctrlMsgChan,转发cmd到ExecNode&lt;/font&gt;" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#00CC66;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-75" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1759.75" y="-399.34000000000003" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-75" value="fsm" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#FF99FF;" parent="1" vertex="1">
          <mxGeometry x="1699.75" y="-529.34" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-84" value="&lt;font style=&quot;font-size: 14px&quot;&gt;cmd.IsolatedNode&lt;/font&gt;" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.435;entryY=0.024;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-79" target="UpMw4r_qUdOqaKaXqRXh-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-85" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-79" target="UpMw4r_qUdOqaKaXqRXh-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-86" value="&lt;font style=&quot;font-size: 14px&quot;&gt;cmd.RelieveNode&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-85" vertex="1" connectable="0">
          <mxGeometry x="-0.1033" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-87" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0.21;entryY=0.036;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-79" target="UpMw4r_qUdOqaKaXqRXh-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-88" value="&lt;font style=&quot;font-size: 14px&quot;&gt;cmd.ShutdownNode&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-87" vertex="1" connectable="0">
          <mxGeometry x="-0.189" y="3" relative="1" as="geometry">
            <mxPoint x="-26.150000000000006" y="-18.35" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-79" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusUnknown&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1649.75" y="-349.34000000000003" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-91" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-80" target="UpMw4r_qUdOqaKaXqRXh-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-95" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1.002;entryY=0.611;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-80" target="UpMw4r_qUdOqaKaXqRXh-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-80" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusAlive&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1939.75" y="-349.34000000000003" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-89" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=0;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-81" target="UpMw4r_qUdOqaKaXqRXh-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-90" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" target="UpMw4r_qUdOqaKaXqRXh-82" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1800" y="-89" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-81" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusIsolated&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1679.75" y="-139.33999999999997" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-82" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusRemoved&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1929.75" y="-129.33999999999997" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-83" value="" style="endArrow=classic;html=1;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" target="UpMw4r_qUdOqaKaXqRXh-79" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1599.75" y="-389.34000000000003" as="sourcePoint" />
            <mxPoint x="1649.75" y="-439.34000000000003" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-97" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;exitX=0.5;exitY=0;exitDx=0;exitDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="870" y="-1070" as="sourcePoint" />
            <mxPoint x="1950" y="-470" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-610" y="-580" />
              <mxPoint x="10" y="-580" />
              <mxPoint x="10" y="-900" />
              <mxPoint x="1970" y="-900" />
              <mxPoint x="1970" y="-470" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-98" value="&lt;font style=&quot;font-size: 18px&quot;&gt;taskManager的作用：&lt;br&gt;1.管理execnode，并可以通过来自Jobmanaager的命令改变节点状态&lt;br&gt;2.管理task，更改其状态和转发task cmd&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="610" y="-1040" width="450" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-102" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;strokeColor=#66CC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-104" target="UpMw4r_qUdOqaKaXqRXh-109" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-103" value="&lt;font style=&quot;font-size: 18px&quot;&gt;启动状态机&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-102" vertex="1" connectable="0">
          <mxGeometry x="0.3148" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-108" value="&lt;font style=&quot;font-size: 14px&quot;&gt;起始状态为StatusCreate&lt;br&gt;通过task.cmdChan接收来自job Manager的http&amp;nbsp; &amp;nbsp;task cmd，然后通过etcd_base中查表对应找到taskMsgChan，然后转发给exec node，然后通过从etcd获取由ExecNode返回的实际的task状态&lt;/font&gt;" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#66CC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-109" edge="1">
          <mxGeometry x="0.0278" y="50" relative="1" as="geometry">
            <mxPoint x="1340" y="773.75" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-109" value="&lt;font style=&quot;font-size: 18px&quot;&gt;fsm&lt;/font&gt;" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#FF99FF;" parent="1" vertex="1">
          <mxGeometry x="1280" y="643.75" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-115" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusCreate&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1230" y="823.75" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-118" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusAlive&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1450" y="823.75" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-121" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusDead&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1250" y="960" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-122" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusUnknown&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1380.25" y="1050" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-123" value="" style="endArrow=classic;html=1;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" target="UpMw4r_qUdOqaKaXqRXh-115" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1180" y="783.75" as="sourcePoint" />
            <mxPoint x="1230" y="733.75" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-127" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;strokeColor=#66CC00;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-126" target="UpMw4r_qUdOqaKaXqRXh-104" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-128" value="&lt;font style=&quot;font-size: 18px&quot;&gt;2.2.3.a.b.b&lt;br&gt;启动task&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="UpMw4r_qUdOqaKaXqRXh-127" vertex="1" connectable="0">
          <mxGeometry x="-0.5869" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-126" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;函数集：&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font size=&quot;3&quot;&gt;a.RebuildTask():&lt;span style=&quot;text-align: center ; background-color: rgb(255 , 255 , 255)&quot;&gt;将task状态为Create的重建出来&lt;/span&gt;&lt;br style=&quot;text-align: center&quot;&gt;&lt;/font&gt;&lt;span style=&quot;text-align: center ; background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;font size=&quot;3&quot;&gt;&lt;br&gt;b.task.Start()&lt;/font&gt;&lt;br&gt;&lt;/span&gt;" style="shape=card;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="729.5" y="230" width="310.5" height="130" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-131" value="&lt;font style=&quot;font-size: 18px&quot;&gt;StatusRemove&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1500" y="950" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="UpMw4r_qUdOqaKaXqRXh-132" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;exitX=0;exitY=1;exitDx=0;exitDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="UpMw4r_qUdOqaKaXqRXh-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="230" y="910" as="sourcePoint" />
            <mxPoint x="920" y="730" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-670" y="-310" />
              <mxPoint x="-780" y="-310" />
              <mxPoint x="-780" y="630" />
              <mxPoint x="540" y="630" />
              <mxPoint x="540" y="730" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="TfOgRGV2h7o3hJ4xQCbi-1" value="&lt;font style=&quot;font-size: 14px&quot;&gt;此部分的转换结果由EcecNode执行完反馈到etcd中&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1060" y="940" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="TfOgRGV2h7o3hJ4xQCbi-4" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;entryX=0.25;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="TfOgRGV2h7o3hJ4xQCbi-6" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1840" y="700" as="sourcePoint" />
            <mxPoint x="1912.92" y="734.6799999999998" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TfOgRGV2h7o3hJ4xQCbi-5" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;entryX=0.153;entryY=0.993;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="TfOgRGV2h7o3hJ4xQCbi-7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1850" y="760" as="sourcePoint" />
            <mxPoint x="2010" y="940" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TfOgRGV2h7o3hJ4xQCbi-6" value="&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;span&gt;JobManager&lt;/span&gt;&lt;br&gt;&lt;span&gt;交互处&lt;/span&gt;&lt;/font&gt;" style="shape=tape;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1910" y="240" width="120" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TfOgRGV2h7o3hJ4xQCbi-7" value="&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;ExecNode&lt;br&gt;交互处&lt;/font&gt;&lt;/span&gt;" style="shape=tape;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2210" y="440" width="120" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TfOgRGV2h7o3hJ4xQCbi-8" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;exitX=0.688;exitY=-0.007;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="TfOgRGV2h7o3hJ4xQCbi-6" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2240" y="60" as="sourcePoint" />
            <mxPoint x="2030" y="-420" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2180" y="239" />
              <mxPoint x="2180" y="-110" />
              <mxPoint x="2200" y="-110" />
              <mxPoint x="2200" y="-400" />
              <mxPoint x="2030" y="-400" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="TfOgRGV2h7o3hJ4xQCbi-9" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;exitX=0.75;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="TfOgRGV2h7o3hJ4xQCbi-7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2300" y="430" as="sourcePoint" />
            <mxPoint x="2030" y="-440" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2300" y="-10" />
              <mxPoint x="2340" y="-10" />
              <mxPoint x="2340" y="-460" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5yKxLC88BkBPKpUSU8He-2" value="&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;b&gt;&lt;i&gt;核心流程：&lt;br&gt;&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font size=&quot;3&quot;&gt;&lt;b&gt;&lt;i&gt;1.初始化etc，task，execnode的管理结构体&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;3&quot;&gt;&lt;b&gt;&lt;i&gt;2.竞选leader，leader负责服务，follower监听leader变化&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;3&quot;&gt;&lt;b&gt;&lt;i&gt;3.leader节点，先将以注册进etcd的execnode，重构并启动，然后运行一个监听后续注册execnode的协程&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;3&quot;&gt;&lt;b&gt;&lt;i&gt;3.1 已启动的exec node，接收来自JobManager的命令，改变其状态机并转发至execnode&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;3&quot;&gt;&lt;b&gt;&lt;i&gt;4.Leader节点，向etcd查询状态为created的task,根据信息创建它并启动，接收JobManager的命令，改变状态机并转发至exec node&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;" parent="1" vertex="1">
          <mxGeometry x="-795" y="-1000" width="960" height="100" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
